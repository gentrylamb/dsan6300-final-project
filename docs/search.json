[
  {
    "objectID": "story.html",
    "href": "story.html",
    "title": "Airline Performance: A Data-Driven Narrative",
    "section": "",
    "text": "Airline performance is a comprehensive indicator of how effectively carriers balance operational efficiency, financial stability, customer satisfaction, and resilience in an ever-changing travel landscape. Evaluating performance requires looking beyond isolated statistics and examining how delays, cancellations, and flight volumes interact with one another. By analyzing these performance measures, we can gain a deeper understanding of the industry’s overall health and the strategic decisions that will shape its future. The analyses in this project use seven different datasets, each derived from SQL queries of a greater FAA database, to uncover patterns in how airlines operate, how airports influence on-time performance, and factors that shape U.S. air travel.\nThe story begins with a basic, but revealing, question: Which airlines struggle most with departure delays? The first visualization provides a clear answer by comparing the maximum departure delay recorded for each major airline.\n\n\n\n\n\n\n\n\n\n\nSource: Airline Performance Analysis Code\nImmediately, certain carriers stand out with extreme single-day delays, some of which stretch many hours. It is crucial to highlight that these specific metrics may have some bias and are more likely to be atypical outliers. They are aggregates of the data representing points where operational strain, weather systems, or congested hubs likely overwhelmed the airline’s schedule. They also show that the airline industry is extremely sensitive to disruptions: a single bottleneck can cascade rapidly.\nBut delays alone don’t tell the whole story. Some airlines regularly depart early, sometimes too early.\n\n\n\n\n\n\n\n\n\n\n\nThe contrast between the maximum early departures and maximum late departures reveals something important: airlines differ not only in how late they run, but also in how aggressively they pad schedules. Early departures may sound great, but they come with their own drawbacks and can be detrimental for travelers, especially those who have connecting flights. An early departure can be just as frustrating as a late one. The visualization suggests that the worst offenders in one category are not always the worst in the other. Alaska Airlines has some of the shortest delays in the industry, as well as having the earliest departures, with their earliest being 40 minutes before scheduled. On the contrary, Southwest Airlines has minimal delays and ranks at the bottom of early departures, suggesting they have achieved an optimal scheduling algorithm.\nFrom here, the narrative turns to a behavioral pattern: when do Americans fly the most? The visualization of total flights by day of the week offers some insights.\n\n\n\n\n\n\n\n\n\n\n\nFlight volume peaks on predictable business-heavy days, particularly Thursdays and Fridays. The ranking annotations reinforce how reliably these patterns emerge. These cycles have operational consequences as airports need to adjust staffing levels, airlines must anticipate gate congestion, and air traffic control must prepare for increases in runway demand. It is rather surprising to see how many fewer flights Saturday has compared to Friday, the busiest day for flying. One might anticipate Saturday to have some “overflow” from the high traffic day, but in fact, it is the opposite, with Saturday being the least trafficked day.\nAirports themselves play a dramatic role in shaping delay performance. Some facilities consistently struggle with congestion, weather, or runway limitations. The next figure highlights the airport with the highest average departure delay for each airline.\n\n\n\n\n\n\n\n\n\n\n\nThis visualization is interesting in that it shows that there is a combination of large hubs and smaller regional airports that create systemic pressure for airlines. Major hubs experience heavy delays primarily because of sheer volume: they handle thousands of daily operations, dense air traffic, complex runway systems, and tightly packed schedules that leave little room for recovery when disruptions occur. A single weather event or equipment issue can ripple across the entire network. In contrast, small regional airports face delays for almost the opposite reason: they often operate with limited resources. Many have only one runway, minimal ground staffing, fewer maintenance crews, and fewer flight options to re-route passengers or swap aircraft. Weather can shut down operations entirely, and when a disruption happens, there are fewer backup plans to keep things moving.\nComplementing delays is the issue of cancellations. Some airports cancel flights overwhelmingly due to weather, while others suffer from carrier-related issues (maintenance, crew scheduling, late arrivals). The dataset identifying the most frequent cancellation reason per airport reveals these distinctions vividly.\n\n\n\n\n\n\n\n\n\n\n\nWeather is overwhelmingly the leading cause of flight cancellations, accounting for the majority of disruptions in all air travel. Severe storms, snow, fog, and high winds can make it unsafe to operate flights, often grounding entire fleets for hours or even days. Carrier-related issues, such as mechanical problems or staffing shortages, are the second most common reason for cancellations, but they occur far less frequently than weather-related disruptions. Interestingly, cancellations due to the National Airspace System (NAS) constraints, such as air traffic control delays or congestion, are nearly nonexistent in comparison. Airports with the highest number of cancellations are all major international hubs. This highlights that even the largest and best-equipped airports are not immune to weather-driven disruptions, which can affect thousands of passengers and ripple across global flight networks. To further reinforce this point, another visualization counts how many airports list each reason as their top cause.\n\n\n\n\n\n\n\n\n\n\n\nTogether, these visualizations show that while weather is a major disruptor, carrier-related cancellations are not uncommon and concentrated at some of the nation’s busiest airports.\nDelays and cancellations give us snapshots, but the aviation system is also dynamic. To see that motion, the analysis turns to daily flight volumes and a 3-day moving average.\n\n\n\n\n\n\n\n\n\n\n\nThis figure tells a story of natural peaks and troughs. High-traffic days often correspond to travel periods such as weekends, while dips follow immediately afterward. The annotations marking the maximum and minimum days help anchor the trends, showing not only when travel surges but also underpin insights from above on peak travel days. In the course of just one month, we cannot determine any seasonal patterns, but we do see a fairly distinct weekly cycle, with flights spiking on Fridays and sinking on Saturdays. The 3-day average is somewhat smoother, but we still see pronounced crests a day after the daily flight spikes.\nWith these pieces, delay extremes, early departures, airport performance, and temporal trends, the final analysis combines multiple datasets to illustrate airline delay profiles. The scatterplot comparing maximum delays, maximum early departures, and worst airport delay provides a multidimensional view of how carriers behave.\n\n\n\n\n\n\n\n\n\n\n\nSome airlines cluster tightly, suggesting consistent scheduling performance. Others sprawl across the chart, indicating higher operational volatility. The size of each point, a reflection of the average delay at the airline’s worst airport, adds depth by highlighting carriers most affected by specific bottleneck airports. For example, SkyWest Airlines experiences high early departures, but also sees significant average delays at its worst airport, as indicated by the size of its point. Most airlines tend to have maximum departure delays below 2000 minutes (~33 hours), while American Airlines experienced a delay of over 4000 minutes (~70 hours) during this time period, indicating a catastrophic incident with one of their flights.\nThe narrative concludes with the airport-level dashboard that merges delay and cancellation metrics.\n\n\n\n\n\n\n\n\n\n\n\nHere, airports with both substantial delays and frequent cancellations emerge as clear operational pain points. Weather-dominated airports cluster differently from carrier-dominated ones, underscoring the varied challenges across the different airlines.\nTogether, these visualizations paint a picture of an aviation network that is reliable in its scheduling but unpredictable in its execution. Each airline has unique delay issues, airports strongly affect the overall performance, and cancellations point to bigger systemic problems. We put this all in context with daily flight volumes. Ultimately, integrating this data explains not just the “what” of U.S. air travel, but the “why” and highlights the system’s biggest pain points."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Airline Performance Analysis",
    "section": "",
    "text": "Airliners Waiting for Takeoff"
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "Airline Performance Analysis",
    "section": "Overview",
    "text": "Overview\nThis project analyzes U.S. airline performance data using SQL generated datasets covering delays, cancellations, airports, airlines, and temporal patterns. This analysis was conducted by Gentry Lamb for the course DSAN-6300 Database Systems and SQL.\nThe goals of the project are to:\n\nUnderstand patterns in flight volume and delays across airlines and airports\nIdentify worst-performing airports for each airline\nExplore temporal trends such as busiest days and moving averages\nBuild clear visual explanations combining multiple datasets\n\nAll analysis is performed in Python, documented through a Quarto website, with a narrative story to demonstrate findings and insights."
  },
  {
    "objectID": "code.html",
    "href": "code.html",
    "title": "Airline Performance Analysis Code",
    "section": "",
    "text": "Objective: Explore airline operational performance in the U.S. using Bureau of Transportation Statistics data.\nKey Questions: 1. Which airlines experience the largest departure delays or early departures? 2. Which days of the week are busiest? 3. Which airports and airlines have the worst average delays? 4. How common are cancellations, and what are the main causes? 5. Are there trends in daily flight volumes over time?\n\n# Package Imports\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nimport calendar\n\n# Read in Data\ndata_dir = \"../data/\"\ndf_max_delay = pd.read_csv(data_dir+\"Miniproject_Lamb_Gentry_gjl53_problem01.csv\")\ndf_early = pd.read_csv(data_dir+\"Miniproject_Lamb_Gentry_gjl53_problem02.csv\")\ndf_days = pd.read_csv(data_dir+\"Miniproject_Lamb_Gentry_gjl53_problem03.csv\")\ndf_avg_delay = pd.read_csv(data_dir+\"Miniproject_Lamb_Gentry_gjl53_problem04.csv\")\ndf_airport = pd.read_csv(data_dir+\"Miniproject_Lamb_Gentry_gjl53_problem05.csv\")\ndf_cancel = pd.read_csv(data_dir+\"Miniproject_Lamb_Gentry_gjl53_problem06b.csv\")\ndf_trends = pd.read_csv(data_dir+\"Miniproject_Lamb_Gentry_gjl53_problem07.csv\")\n\n\n# Create own theme for plots\nimport matplotlib as mpl\nimport matplotlib.colors as mcolors\n\n# Category palette\ncategory_palette = [\n    \"#6ca0dc\",  # light denim blue\n    \"#ffb5a7\",  # blush coral\n    \"#88c0d0\",  # arctic blue\n    \"#a5a8f0\",  # soft violet\n    \"#f6bd60\",  # golden pastel\n    \"#cb997e\",  # tan\n    \"#b5ead7\",  # mint green \n]\n\n# Continuous palette\ncont_colors = [category_palette[0], category_palette[6], category_palette[3]]\ncontinuous_cmap = mcolors.LinearSegmentedColormap.from_list(\n    \"dsan6300\", cont_colors\n)\nmpl.colormaps.register(continuous_cmap, force=True)\ncontinuous_palette = sns.color_palette(\"dsan6300\", n_colors=15)\n\n# Plot features\ncustom_style = {\n    # Background\n    \"figure.facecolor\": \"#eaf4f9\",\n    \"axes.facecolor\": \"#eaf4f9\",\n    # Axes\n    \"axes.edgecolor\": \"#5c5c5c\",\n    \"axes.labelcolor\": \"#333333\",\n    \"axes.titlesize\": 18,\n    \"axes.titlecolor\": \"#2f2f2f\",\n    \"axes.labelsize\": 14,\n    # Ticks\n    \"xtick.color\": \"#333333\",\n    \"ytick.color\": \"#333333\",\n    \"xtick.labelsize\": 12,\n    \"ytick.labelsize\": 12,\n    # Grid\n    \"grid.color\": \"#cccccc\",\n    # Legend\n    \"legend.fontsize\": 12,\n    \"legend.title_fontsize\": 14,\n    \"legend.edgecolor\": \"#333333\",\n    # Font\n    \"font.family\": \"sans-serif\",\n    \"font.sans-serif\": [\"Segoe UI\", \"Lato\", \"DejaVu Sans\"],\n    # Default line/mark color\n    \"axes.prop_cycle\": mpl.cycler(color=category_palette)\n}\n\n# funciton to define style and palette\ndef use_custom_style(palette=continuous_palette):\n    mpl.rcParams.update(custom_style)\n    sns.set_palette(palette)\n\n\nDeparture Delays by Airline\n\nData: Query #1 – maximal departure delays per airline.\nVisualization: Horizontal bar chart showing each airline’s maximum delay.\nInsight:\n\nIdentify airlines with extreme delays.\nDiscuss operational challenges (weather, airline size, hub congestion).\n\n\n\nuse_custom_style(continuous_palette)\n# Drop Airline Code information after colon for better viewing\ndf_max_delay['Airline_clean'] = df_max_delay['Airline'].str.split(':').str[0]\n# Create barplot of airline versus departure delay\nplt.figure(figsize=(10,8))\nsns.barplot(x=\"Max_Departure_Delay\", y=\"Airline_clean\", data=df_max_delay, hue=\"Airline\", legend=False)\nplt.title(\"Maximum Departure Delay by Airline\")\nplt.xlabel(\"Delay (minutes)\")\nplt.ylabel(\"Airline\")\nplt.show()\n\n\n\n\n\n\n\n\n\n\nMaximal Early Departures\n\nData: Query #2 – maximal early departures per airline.\nVisualization: Horizontal bar chart showing airlines with largest early departures.\nInsight:\n\nIdentify airlines that depart significantly early (potentially causing passenger issues).\nCompare early departures vs. delays.\n\n\n\nuse_custom_style(continuous_palette)\n# Drop Airline Code information after colon for better viewing\ndf_early['Airline_clean'] = df_early['Airline'].str.split(':').str[0]\n# Create barplot of airline versus early departure\nplt.figure(figsize=(10,8))\nsns.barplot(x=\"Max_Early_Departure\", y=\"Airline_clean\", data=df_early, hue=\"Airline\", legend=False)\nplt.title(\"Maximum Early Departure by Airline\")\nplt.xlabel(\"Minutes Early\")\nplt.ylabel(\"Airline\")\nplt.show()\n\n\n\n\n\n\n\n\n\n\nBusiest Days of the Week\n\nData: Query #3 – flights per day of the week.\nVisualization:\n\nBar chart of total flights by day of the week.\nOverlay rank labels for clarity.\n\nInsight:\n\nIdentify busiest days (e.g., Monday or Friday).\nDiscuss operational implications, staffing, and hub congestion.\n\n\n\nuse_custom_style(category_palette)\n# Create barplot of day versus number of flights on avg\nplt.figure(figsize=(10,8))\nsns.barplot(x=\"Day\", y=\"Num_Flights\", data=df_days, legend=False, hue=\"Day\")\nplt.title(\"Number of Flights by Day of the Week\")\nplt.xlabel(\"Day of Week\")\nplt.ylabel(\"Number of Flights\")\nfor i, row in df_days.iterrows():\n    plt.text(i, row.Num_Flights - 5000, f\"Rank {row.Day_Rank}\", ha='center', color='white')\nplt.show()\n\n\n\n\n\n\n\n\n\n\nWorst Airport by Average Departure Delay\n\nData: Query #4 – airport with highest average departure delay.\nVisualization: Highlight the airport in a single point chart or infographic.\nInsight:\n\nName the “worst-performing” airport.\nDiscuss possible causes: congestion, weather, operational factors.\n\n\n\nuse_custom_style(category_palette)\n# Drop Airport city information before colon for better viewing\ndf_airport['Airport_Name_clean'] = df_airport['Airport_Name'].str.split(':').str[1]\n# Create barplot of day versus number of flights on avg\nplt.figure(figsize=(10,8))\nplt.bar(df_airport[\"Airport_Name_clean\"], df_airport[\"Highest_Avg_Delay\"])\nplt.title(\"Airport with Highest Average Departure Delay\")\nplt.ylabel(\"Average Departure Delay (minutes)\")\nplt.xlabel(\"Airport\")\n# Rotate x-axis labels 45 degrees\nplt.xticks(rotation=45, ha='right')\nplt.show()\n\n\n\n\n\n\n\n\n\n\nMost Frequent Reason per Airport\n\nData: Query #6b.\nVisualization:\n\nStacked bar chart: airports vs. cancellation reasons.\nTop 10 airports by number of cancellations for clarity.\n\nInsight:\n\nWeather vs. carrier vs. NAS vs. security.\nOperational recommendations to reduce cancellations.\n\n\n\nuse_custom_style(category_palette)\n# Drop Airport city information before colon for better viewing\ndf_cancel['Airport_Name_clean'] = df_cancel['Airport_Name'].str.split(':').str[1]\n# Select top 10 airports by total cancellations\ntop_airports = df_cancel.groupby(\"Airport_Name_clean\")[\"Num_Cancelled\"].sum().nlargest(10).index\ndf_top = df_cancel[df_cancel.Airport_Name_clean.isin(top_airports)]\n# Ensure bars are ordered by total cancellations\nairport_order = df_top.groupby(\"Airport_Name_clean\")[\"Num_Cancelled\"].sum().sort_values(ascending=False).index\n# Create barplot of day versus number of flights on avg\nplt.figure(figsize=(10,8))\nsns.barplot(x=\"Num_Cancelled\", y=\"Airport_Name_clean\", hue=\"Most_Frequent_Reason\", data=df_top, order=airport_order)\nplt.legend(title=\"Cancellation Reason\")\nplt.title(\"Top Airports by Most Frequent Cancellation Reason\")\nplt.ylabel(\"Airport Name\")\nplt.xlabel(\"Number of Cancelled Flights\")\nplt.show()\n\n\n\n\n\n\n\n\n\ndf_cancel.groupby(\"Most_Frequent_Reason\")[\"Num_Cancelled\"].sum().sort_values(ascending=False)\n\nMost_Frequent_Reason\nWeather                3947\nCarrier                1052\nNational Air System      69\nName: Num_Cancelled, dtype: int64\n\n\n\nuse_custom_style(category_palette)\n# get counts of airports in each cancellation\nairport_count_by_reason = df_cancel['Most_Frequent_Reason'].value_counts()\n# plot barplot of airports by each reason\nplt.figure(figsize=(8,6))\nsns.barplot(\n    x=airport_count_by_reason.index,\n    y=airport_count_by_reason.values,\n    hue=airport_count_by_reason.index\n)\nplt.title(\"Number of Airports by Top Cancellation Reason\")\nplt.xlabel(\"Cancellation Reason\")\nplt.ylabel(\"Number of Airports\")\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\nTemporal Trends in Flight Volume\n\nData: Query #7 – 3-day rolling average of daily flights.\nVisualization:\n\nLine chart: Flights_Per_Day vs. Avg_Previous_3_Days.\nHighlight trends, peaks, and dips.\n\nInsight:\n\nDetect periods of higher traffic.\nIdentify volatility and possible operational strain.\n\n\n\n# function for annotations\ndef annotate_point(idx, metric='Max'):\n    # get values\n    flight_date = df_trends['FlightDate'][idx]\n    flights = df_trends[\"Flights_Per_Day\"][idx]\n    day_name = calendar.day_name[flight_date.weekday()]\n    x_offset = -pd.Timedelta(hours=36) if metric == 'Max' else pd.Timedelta(hours=72)\n    y_offset = -1500 if metric == 'Max' else 500\n    # add annotation\n    plt.annotate(f'{metric} flights: {flights}\\nOccurred on a {day_name}',\n             xy=(flight_date, flights),\n             xytext=(flight_date+x_offset, flights+y_offset),\n             arrowprops=dict(facecolor='green', arrowstyle='-&gt;'),\n             ha='center', fontsize=10)\n\n\nuse_custom_style(category_palette)\n# convert date column to datetime\ndf_trends[\"FlightDate\"] = pd.to_datetime(df_trends[\"FlightDate\"])\n# Create barplot of day versus number of flights on avg\nplt.figure(figsize=(15,6))\nplt.plot(df_trends[\"FlightDate\"], df_trends[\"Flights_Per_Day\"], label=\"Flights Per Day\", marker='o')\nplt.plot(df_trends[\"FlightDate\"], df_trends[\"Avg_Previous_3_Days\"], label=\"3-Day Moving Average\", linestyle='--', marker='d')\nplt.title(\"Daily Flights and 3-Day Moving Average\")\nplt.xlabel(\"Date\")\nplt.ylabel(\"Number of Flights\")\nplt.legend()\n# rotate labels\nplt.xticks(rotation=20, ha='right')\n\n# Annotate max and min of Flights_Per_Day\nmax_idx = df_trends[\"Flights_Per_Day\"].idxmax()\nmin_idx = df_trends[\"Flights_Per_Day\"].idxmin()\nannotate_point(max_idx, 'Max')\nannotate_point(min_idx, 'Min')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\nAirline Delay Profiles\n\nData: Query #1 (max delays) + Query #2 (max early departures) + Query #5 (worst airport per airline)\nVisualizations:\n\nScatter plot: X-axis = max early departure, Y-axis = max delay, color = airline, size = average delay at worst airport.\n\nInsight:\n\nSee which airlines are the most inconsistent, and which airports drive those delays.\n\n\n\n# Merge datasets\ndf_airline_delay = df_max_delay.merge(df_early.drop(columns=['Airline_clean']), on=\"Airline\") \\\n                               .merge(df_airport[['Airline_Name','Airport_Name','Highest_Avg_Delay']], \n                                      left_on='Airline', right_on='Airline_Name')\n\nplt.figure(figsize=(12,6))\nscatter = sns.scatterplot(\n    data=df_airline_delay,\n    x='Max_Early_Departure',\n    y='Max_Departure_Delay',\n    size='Highest_Avg_Delay',\n    hue='Airline_clean',\n    palette='tab20',\n    legend='brief',\n    sizes=(100,500),\n)\nplt.title(\"Airline Delay Profile: Max Early vs Max Late Departures\")\nplt.xlabel(\"Max Early Departure (minutes)\")\nplt.ylabel(\"Max Departure Delay (minutes)\")\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\nAirport Performance Dashboard\n\nData: Query #5 (worst airport per airline) + Query #6b (cancellation reasons)\nVisualizations:\n\nScatter plot: X-axis = avg delay, Y-axis = number of cancellations, point size = number of flights, color = airport.\n\nInsight:\n\nAirports that are both delayed and frequently canceled can be flagged for operational focus.\n\n\n\nuse_custom_style(category_palette)\n# Merge delays and cancellations\ndf_airport_perf = df_airport.merge(df_cancel, left_on='Airport_Name', right_on='Airport_Name', how='left')\n# plot scatter plot of avg delay against number of cancellations\nplt.figure(figsize=(12,6))\nsns.scatterplot(\n    data=df_airport_perf,\n    x='Highest_Avg_Delay',\n    y='Num_Cancelled',\n    hue='Most_Frequent_Reason',\n    s=100\n)\nplt.title(\"Airport Performance: Avg Delay vs. Cancellations\")\nplt.xlabel(\"Average Departure Delay (minutes)\")\nplt.ylabel(\"Number of Cancellations\")\nplt.legend(title='Cancellation Reason')\nplt.tight_layout()\nplt.show()"
  },
  {
    "objectID": "sql.html",
    "href": "sql.html",
    "title": "SQL Queries Used in This Project",
    "section": "",
    "text": "This page collects all SQL queries used throughout the analysis. They are included for transparency, and to provide a complete reference for the data-processing logic used in the project."
  },
  {
    "objectID": "sql.html#maximum-departure-delay-per-airline",
    "href": "sql.html#maximum-departure-delay-per-airline",
    "title": "SQL Queries Used in This Project",
    "section": "1. Maximum Departure Delay per Airline",
    "text": "1. Maximum Departure Delay per Airline\n-- 1) Find maximal departure delay in minutes for each airline. Sort results from smallest to largest maximum delay. Output airline names and values of the delay.\nselect\n    a.Name as Airline,\n    max(p.DepDelayMinutes) as Max_Departure_Delay\nfrom\n    al_perf p,\n    L_AIRLINE_ID a\nwhere\n    p.DOT_ID_Reporting_Airline = a.ID\ngroup by\n    a.Name\norder by\n    Max_Departure_Delay asc;\n-- 15 rows"
  },
  {
    "objectID": "sql.html#maximum-early-departures-per-airline",
    "href": "sql.html#maximum-early-departures-per-airline",
    "title": "SQL Queries Used in This Project",
    "section": "2. Maximum Early Departures per Airline",
    "text": "2. Maximum Early Departures per Airline\n-- 2) Find maximal early departures in minutes for each airline. Sort results from largest to smallest. Output airline names.\n-- *Note: Need to use DepDelay so early departures aren't counted as zeros.\nselect\n    a.Name as Airline,\n    abs(min(p.DepDelay)) as Max_Early_Departure\nfrom\n    al_perf p,\n    L_AIRLINE_ID a\nwhere\n    p.DOT_ID_Reporting_Airline = a.ID\ngroup by\n    a.Name\norder by\n    Max_Early_Departure desc;\n-- 15 rows"
  },
  {
    "objectID": "sql.html#rank-days-of-week-by-total-flights",
    "href": "sql.html#rank-days-of-week-by-total-flights",
    "title": "SQL Queries Used in This Project",
    "section": "3. Rank Days of Week by Total Flights",
    "text": "3. Rank Days of Week by Total Flights\n-- 3) Rank days of the week by the number of flights performed by all airlines on that day (1 is the busiest). Output the day of the week names, number of flights and ranks in the rank increasing order.\nselect\n    w.Day,\n    sum(p.flights) as Num_Flights,\n    rank() over (order by sum(p.flights) desc) as Day_Rank\nfrom\n    al_perf p,\n    L_WEEKDAYS w\nwhere\n    p.DayOfWeek = w.Code\ngroup by\n    w.Day\norder by\n    Day_Rank asc;\n-- 7 rows"
  },
  {
    "objectID": "sql.html#airport-with-the-highest-average-departure-delay",
    "href": "sql.html#airport-with-the-highest-average-departure-delay",
    "title": "SQL Queries Used in This Project",
    "section": "4. Airport With the Highest Average Departure Delay",
    "text": "4. Airport With the Highest Average Departure Delay\n-- 4) Find the airport that has the highest average departure delay among all airports. Consider 0 minutes delay for flights that departed early. Output one line of results: the airport name, code, and average delay.\n-- *Note: Need to use DepDelayMinutes so early departures aren counted as zeros.\nselect\n    a.Name as Airport_Name,\n    a.Code as Airport_Code,\n    avg(p.DepDelayMinutes) as Avg_Departure_Delay\nfrom\n    al_perf p,\n    L_AIRPORT a\nwhere\n    p.Origin = a.Code\ngroup by\n    p.Origin, a.Name\norder by\n    Avg_Departure_Delay desc\nlimit 1;\n-- 1 row"
  },
  {
    "objectID": "sql.html#worst-airport-per-airline",
    "href": "sql.html#worst-airport-per-airline",
    "title": "SQL Queries Used in This Project",
    "section": "5. Worst Airport per Airline",
    "text": "5. Worst Airport per Airline\n-- 5) For each airline find an airport where it has the highest average departure delay. Output an airline name, a name of the airport that has the highest average delay, and the value of that average delay.\n-- *Note: Used DepDelayMinutes so early departures are counted as zeros, which properly accounts for the prompt's implied goal of measuring the average positive delay time.\nwith avg_delays as (\n    select\n        al.Name as Airline_Name,\n        ap.Name as Airport_Name,\n        avg(p.DepDelayMinutes) as Avg_Delay,\n        rank() over (\n            partition by p.DOT_ID_Reporting_Airline\n            order by avg(p.DepDelayMinutes) desc\n        ) as delay_rank\n    from\n        al_perf p,\n        L_AIRLINE_ID al,\n        L_AIRPORT ap\n    where\n        p.Origin = ap.Code and\n        p.DOT_ID_Reporting_Airline = al.ID\n    group by\n        al.Name, ap.Name, p.DOT_ID_Reporting_Airline, p.Origin\n)\nselect\n    Airline_Name,\n    Airport_Name,\n    Avg_Delay as Highest_Avg_Delay\nfrom\n    avg_delays\nwhere\n    delay_rank = 1\norder by\n    Airline_Name;\n-- 15 rows"
  },
  {
    "objectID": "sql.html#a.-count-of-canceled-flights",
    "href": "sql.html#a.-count-of-canceled-flights",
    "title": "SQL Queries Used in This Project",
    "section": "6a. Count of Canceled Flights",
    "text": "6a. Count of Canceled Flights\n-- 6a) Check if your dataset has any canceled flights.\nselect\n    count(*) as Num_Cancelled_Flights\nfrom\n    al_perf\nwhere\n    Cancelled = 1;\n-- 1 row"
  },
  {
    "objectID": "sql.html#b.-most-frequent-cancelation-reason-per-airport",
    "href": "sql.html#b.-most-frequent-cancelation-reason-per-airport",
    "title": "SQL Queries Used in This Project",
    "section": "6b. Most Frequent Cancelation Reason per Airport",
    "text": "6b. Most Frequent Cancelation Reason per Airport\n-- 6b) If it does, what was the most frequent reason for each departure airport? Output airport name, the most frequent reason, and the number of cancelations for that reason.\nwith reason_counts as (\n    select\n        ap.Name as Airport_Name,\n        p.Origin as Airport_Code,\n        c.reason as Cancel_Reason,\n        count(*) as Num_Cancelled,\n        rank() over (\n            partition by p.Origin\n            order by count(*) desc\n        ) as cancel_rank\n    from\n        al_perf p,\n        L_AIRPORT ap,\n        L_CANCELATION c\n    where\n        p.Origin = ap.Code and\n        p.CancellationCode = c.Code and\n        p.Cancelled = 1\n    group by\n        ap.Name, p.Origin, c.Reason\n)\nselect\n    Airport_Name,\n    Cancel_Reason as Most_Frequent_Reason,\n    Num_Cancelled\nfrom\n    reason_counts\nwhere\n    cancel_rank = 1\norder by\n    Airport_Name;\n-- 285 rows"
  },
  {
    "objectID": "sql.html#day-moving-average-of-flights",
    "href": "sql.html#day-moving-average-of-flights",
    "title": "SQL Queries Used in This Project",
    "section": "7. 3-Day Moving Average of Flights",
    "text": "7. 3-Day Moving Average of Flights\n-- 7) Build a report that for each day output average number of flights over the preceding 3 days.\n-- *Note: Prompt asks for 3 previous days, not including current day.\nwith daily_counts as (\n    select\n        -- FlightDate,\n        cast(FlightDate as date) as FlightDate,\n        count(*) as Flights_Per_Day\n    from\n        al_perf\n    group by\n        FlightDate\n)\nselect\n    FlightDate,\n    Flights_Per_Day,\n    avg(Flights_Per_Day)\n        over (\n            order by FlightDate\n            rows between 3 preceding and 1 preceding\n        ) as Avg_Previous_3_Days\nfrom\n    daily_counts\nwhere\n    FlightDate is not null\norder by\n    FlightDate;\n-- 31 rows"
  }
]